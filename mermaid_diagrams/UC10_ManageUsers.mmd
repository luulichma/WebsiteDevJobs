sequenceDiagram
    actor Admin as âš™ï¸ Quáº£n trá»‹ viÃªn<br/>(Admin)
    participant UI as ğŸ–¥ï¸ Giao diá»‡n<br/>(Admin Dashboard)
    participant Server as âš™ï¸ Server<br/>(Backend)
    participant DB as ğŸ’¾ Database
    participant Email as ğŸ“§ Email Service

    Note over Admin,Email: UC10: Quáº£n lÃ½ ngÆ°á»i dÃ¹ng

    %% Xem danh sÃ¡ch users
    Admin->>UI: 1. Truy cáº­p "Quáº£n lÃ½ ngÆ°á»i dÃ¹ng"
    UI->>Server: 2. GET /api/admin/users
    Server->>DB: 3. SELECT * FROM Users
    DB-->>Server: 4. Tráº£ vá» danh sÃ¡ch users
    Server-->>UI: 5. Tráº£ vá» dá»¯ liá»‡u
    UI-->>Admin: 6. Hiá»ƒn thá»‹ báº£ng danh sÃ¡ch

    %% TÃ¬m kiáº¿m
    Admin->>UI: 7. Nháº­p tá»« khÃ³a tÃ¬m kiáº¿m
    UI->>Server: 8. GET /api/admin/users?search=...&role=...
    Server->>DB: 9. SELECT vá»›i WHERE Ä‘iá»u kiá»‡n
    DB-->>Server: 10. Tráº£ vá» káº¿t quáº£
    Server-->>UI: 11. Tráº£ vá» dá»¯ liá»‡u
    UI-->>Admin: 12. Hiá»ƒn thá»‹ káº¿t quáº£

    %% Xem chi tiáº¿t
    rect rgb(220, 240, 255)
        Note over Admin,DB: Xem chi tiáº¿t user
        Admin->>UI: 13. Click "Xem chi tiáº¿t"
        UI->>Server: 14. GET /api/admin/users/{id}
        Server->>DB: 15. SELECT user, history
        DB-->>Server: 16. Tráº£ vá» thÃ´ng tin
        Server-->>UI: 17. Tráº£ vá» dá»¯ liá»‡u
        UI-->>Admin: 18. Hiá»ƒn thá»‹ chi tiáº¿t
    end

    %% KhÃ³a tÃ i khoáº£n
    rect rgb(255, 230, 230)
        Note over Admin,Email: KhÃ³a tÃ i khoáº£n
        Admin->>UI: 19. Click "KhÃ³a", nháº­p lÃ½ do
        UI->>Server: 20. POST /api/admin/users/{id}/suspend
        Server->>DB: 21. UPDATE Users SET status='suspended'
        DB-->>Server: 22. Cáº­p nháº­t thÃ nh cÃ´ng
        Server->>Email: 23. Gá»­i email thÃ´ng bÃ¡o
        Email-->>Server: 24. Email sent
        Server-->>UI: 25. Tráº£ vá» success
        UI-->>Admin: 26. "ÄÃ£ khÃ³a tÃ i khoáº£n"
    end

    %% Má»Ÿ khÃ³a
    rect rgb(230, 255, 230)
        Note over Admin,Email: Má»Ÿ khÃ³a tÃ i khoáº£n
        Admin->>UI: 27. Click "Má»Ÿ khÃ³a"
        UI->>Server: 28. POST /api/admin/users/{id}/activate
        Server->>DB: 29. UPDATE Users SET status='active'
        DB-->>Server: 30. Cáº­p nháº­t thÃ nh cÃ´ng
        Server->>Email: 31. Gá»­i email thÃ´ng bÃ¡o
        Email-->>Server: 32. Email sent
        Server-->>UI: 33. Tráº£ vá» success
        UI-->>Admin: 34. "ÄÃ£ má»Ÿ khÃ³a"
    end

    %% Chá»‰nh sá»­a
    rect rgb(255, 250, 230)
        Note over Admin,Email: Chá»‰nh sá»­a thÃ´ng tin
        Admin->>UI: 35. Click "Sá»­a", nháº­p thÃ´ng tin
        UI->>Server: 36. PUT /api/admin/users/{id}
        Server->>DB: 37. Validate email unique
        
        alt Email Ä‘Ã£ tá»“n táº¡i
            DB-->>Server: 38a. Email duplicate
            Server-->>UI: 39a. Error
            UI-->>Admin: 40a. Hiá»ƒn thá»‹ lá»—i
        else Email há»£p lá»‡
            DB-->>Server: 38b. OK
            Server->>DB: 41b. UPDATE Users
            DB-->>Server: 42b. Updated
            Server->>Email: 43b. Gá»­i email
            Email-->>Server: 44b. Sent
            Server-->>UI: 45b. Success
            UI-->>Admin: 46b. "Cáº­p nháº­t thÃ nh cÃ´ng"
        end
    end

    %% XÃ³a user
    rect rgb(255, 240, 240)
        Note over Admin,DB: XÃ³a user
        Admin->>UI: 47. Click "XÃ³a", nháº­p email
        UI->>Server: 48. DELETE /api/admin/users/{id}
        Server->>DB: 49. CHECK activities
        
        alt CÃ³ hoáº¡t Ä‘á»™ng
            DB-->>Server: 50a. CÃ³ dá»¯ liá»‡u
            Server-->>UI: 51a. Error
            UI-->>Admin: 52a. "Äá» xuáº¥t KhÃ³a"
        else KhÃ´ng cÃ³ hoáº¡t Ä‘á»™ng
            DB-->>Server: 50b. KhÃ´ng cÃ³
            Server->>DB: 53b. UPDATE Users SET status='deleted'
            DB-->>Server: 54b. Deleted
            Server-->>UI: 55b. Success
            UI-->>Admin: 56b. "ÄÃ£ xÃ³a"
        end
    end
