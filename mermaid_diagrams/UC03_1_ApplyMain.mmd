sequenceDiagram
    actor Candidate as ğŸ‘¤ á»¨ng viÃªn<br/>(Candidate)
    participant UI as ğŸ–¥ï¸ Giao diá»‡n<br/>(Job Detail Page)
    participant Server as âš™ï¸ Server<br/>(Backend)
    participant Storage as â˜ï¸ Cloud Storage<br/>(Cloudinary/S3)
    participant DB as ğŸ’¾ Database

    Note over Candidate,DB: UC03: á»¨ng tuyá»ƒn cÃ´ng viá»‡c - Luá»“ng chÃ­nh

    Candidate->>UI: 1. Xem trang chi tiáº¿t Job
    UI-->>Candidate: 2. Hiá»ƒn thá»‹ thÃ´ng tin Job + "Apply Now"
    
    Candidate->>UI: 3. Nháº¥n "Apply Now"
    UI-->>Candidate: 4. Hiá»ƒn thá»‹ Form ná»™p há»“ sÆ¡
    
    Candidate->>UI: 5. Táº£i file CV (PDF)
    Candidate->>UI: 6. Viáº¿t Cover Letter
    Candidate->>UI: 7. Nháº¥n "Ná»™p há»“ sÆ¡"
    
    UI->>Server: 8. POST /api/applications<br/>{job_id, cv_file, cover_letter}
    
    %% File validation
    Server->>Server: 9. Validate file<br/>(format=PDF?, size<5MB?)
    
    alt E1: File khÃ´ng há»£p lá»‡
        Server-->>UI: 10a. Error: Invalid file
        UI-->>Candidate: 11a. âŒ "Chá»‰ cháº¥p nháº­n PDF <5MB"
    else File há»£p lá»‡
        %% Check duplicate
        Server->>DB: 10b. SELECT FROM Applications<br/>WHERE job_id=? AND candidate_id=?
        
        alt E3: ÄÃ£ ná»™p Ä‘Æ¡n
            DB-->>Server: 11c. ÄÃ£ tá»“n táº¡i record
            Server-->>UI: 12c. Error: Already applied
            UI-->>Candidate: 13c. âš ï¸ "Báº¡n Ä‘Ã£ ná»™p há»“ sÆ¡ rá»“i"
        else ChÆ°a ná»™p - OK
            DB-->>Server: 11d. KhÃ´ng tá»“n táº¡i
            
            %% Upload to cloud
            Server->>Storage: 12d. Upload CV file
            Storage-->>Server: 13d. Tráº£ vá» cv_url
            
            %% Save to DB
            Server->>DB: 14d. INSERT Applications<br/>(job_id, candidate_id, cv_url,<br/>cover_letter, status='pending',<br/>applied_at=NOW())
            DB-->>Server: 15d. Success
            
            Server-->>UI: 16d. Success response
            UI-->>Candidate: 17d. âœ… "Ná»™p há»“ sÆ¡ thÃ nh cÃ´ng!"
        end
    end
