sequenceDiagram
    actor Recruiter as üëî Nh√† tuy·ªÉn d·ª•ng<br/>(Recruiter)
    participant UI as üñ•Ô∏è Giao di·ªán<br/>(UI)
    participant Server as ‚öôÔ∏è Server<br/>(Backend)
    participant DB as üíæ Database
    participant Email as üìß Email Service

    Note over Recruiter,Email: UC08: Qu·∫£n l√Ω c√°c b√†i ƒëƒÉng tin tuy·ªÉn d·ª•ng

    %% Xem danh s√°ch
    Recruiter->>UI: 1. Truy c·∫≠p "Qu·∫£n l√Ω tin tuy·ªÉn d·ª•ng"
    UI->>Server: 2. GET /api/recruiter/jobs
    Server->>DB: 3. SELECT * FROM Jobs<br/>WHERE company_id = ?<br/>ORDER BY created_at DESC
    DB-->>Server: 4. Tr·∫£ v·ªÅ danh s√°ch jobs
    Server-->>UI: 5. Tr·∫£ v·ªÅ d·ªØ li·ªáu jobs
    UI-->>Recruiter: 6. Hi·ªÉn th·ªã b·∫£ng danh s√°ch jobs<br/>(Title, Posted, Expiry, Applications, Status, Actions)

    %% Ch·ªçn h√†nh ƒë·ªông - V√≠ d·ª•: Edit Job
    Recruiter->>UI: 7. Nh·∫•n n√∫t "Edit" tr√™n 1 job
    UI->>Server: 8. GET /api/jobs/:id
    Server->>DB: 9. SELECT * FROM Jobs<br/>WHERE id = ? AND company_id = ?
    DB-->>Server: 10. Tr·∫£ v·ªÅ th√¥ng tin job
    Server-->>UI: 11. Tr·∫£ v·ªÅ data
    UI-->>Recruiter: 12. Hi·ªÉn th·ªã form ch·ªânh s·ª≠a<br/>(pre-fill d·ªØ li·ªáu)

    %% Ch·ªânh s·ª≠a v√† l∆∞u
    Recruiter->>UI: 13. Ch·ªânh s·ª≠a th√¥ng tin<br/>(Title, Description, Salary, Location...)
    Recruiter->>UI: 14. Nh·∫•n "L∆∞u thay ƒë·ªïi"
    
    UI->>Server: 15. PUT /api/jobs/:id<br/>(Updated data)
    
    Server->>Server: 16. Validate d·ªØ li·ªáu<br/>(Title not empty, Expiry > Today,<br/>Salary min <= max)
    
    alt Validation th√†nh c√¥ng
        Server->>DB: 17. UPDATE Jobs<br/>SET title=?, description=?, salary_min=?,<br/>salary_max=?, location=?, updated_at=NOW()<br/>WHERE id=? AND company_id=?
        DB-->>Server: 18. X√°c nh·∫≠n c·∫≠p nh·∫≠t
        
        Server->>DB: 19. INSERT INTO JobLogs<br/>(job_id, action, admin_id, details)
        DB-->>Server: 20. Log ƒë√£ l∆∞u
        
        Server-->>UI: 21. Tr·∫£ v·ªÅ success
        UI-->>Recruiter: 22. ‚úÖ "C·∫≠p nh·∫≠t tin th√†nh c√¥ng"
        UI->>UI: 23. Quay l·∫°i danh s√°ch
        
    else Validation th·∫•t b·∫°i
        Server-->>UI: ‚ùå L·ªói validation<br/>(Title tr·ªëng, Expiry < Today...)
        UI-->>Recruiter: Hi·ªÉn th·ªã th√¥ng b√°o l·ªói<br/>t·∫°i c√°c tr∆∞·ªùng kh√¥ng h·ª£p l·ªá
    end

    %% Gia h·∫°n tin (Alternative flow)
    rect rgb(240, 248, 255)
        Note over Recruiter,Email: Alternative Flow: Gia h·∫°n tin
        Recruiter->>UI: A1. Nh·∫•n "Renew" tr√™n tin h·∫øt h·∫°n
        UI->>Server: A2. POST /api/jobs/:id/renew
        
        Server->>Server: A3. Ki·ªÉm tra credits/subscription
        
        alt ƒê·ªß credits
            Server->>DB: A4. UPDATE Jobs<br/>SET expiry_date = DATE_ADD(NOW(), 30),<br/>status = 'Active'
            DB-->>Server: A5. X√°c nh·∫≠n
            Server->>DB: A6. Tr·ª´ credits
            Server-->>UI: A7. Success
            UI-->>Recruiter: A8. ‚úÖ "Gia h·∫°n th√†nh c√¥ng ƒë·∫øn [date]"
        else H·∫øt credits
            Server-->>UI: ‚ùå Kh√¥ng ƒë·ªß credits
            UI-->>Recruiter: "Vui l√≤ng n√¢ng c·∫•p g√≥i"
        end
    end

    %% ƒê√≥ng tin (Alternative flow)
    rect rgb(255, 250, 240)
        Note over Recruiter,Email: Alternative Flow: ƒê√≥ng tin
        Recruiter->>UI: B1. Nh·∫•n "Close" tr√™n tin Active
        UI-->>Recruiter: B2. H·ªôp tho·∫°i x√°c nh·∫≠n
        Recruiter->>UI: B3. Nh·∫•n "X√°c nh·∫≠n"
        UI->>Server: B4. PUT /api/jobs/:id/close
        Server->>DB: B5. UPDATE Jobs<br/>SET status = 'Closed',<br/>closed_at = NOW()
        DB-->>Server: B6. X√°c nh·∫≠n
        Server->>Email: B7. G·ª≠i email th√¥ng b√°o<br/>ƒë·∫øn ·ª©ng vi√™n (optional)
        Server-->>UI: B8. Success
        UI-->>Recruiter: B9. ‚úÖ "ƒê√£ ƒë√≥ng tin"
    end

    Note over Recruiter,Email: K·∫øt th√∫c use case
