<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose'
        });
    </script>
    <style>
        body {
            margin: 0;
            padding: 40px;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .mermaid {
            background: white;
        }
    </style>
</head>
<body>
    <div class="mermaid">
sequenceDiagram
    actor Recruiter as üëî Nh√† tuy·ªÉn d·ª•ng<br/>(Recruiter)
    participant UI as üñ•Ô∏è Giao di·ªán<br/>(UI)
    participant Server as ‚öôÔ∏è Server<br/>(Backend)
    participant DB as üíæ Database

    Note over Recruiter,DB: UC08.1: Xem danh s√°ch & Ch·ªânh s·ª≠a tin

    %% Xem danh s√°ch
    Recruiter->>UI: 1. Truy c·∫≠p "Qu·∫£n l√Ω tin tuy·ªÉn d·ª•ng"
    UI->>Server: 2. GET /api/recruiter/jobs
    Server->>DB: 3. SELECT * FROM Jobs<br/>WHERE company_id = ?<br/>ORDER BY created_at DESC
    DB-->>Server: 4. Tr·∫£ v·ªÅ danh s√°ch jobs
    Server-->>UI: 5. Tr·∫£ v·ªÅ d·ªØ li·ªáu jobs
    UI-->>Recruiter: 6. Hi·ªÉn th·ªã b·∫£ng danh s√°ch jobs<br/>(Title, Posted, Expiry, Applications, Status, Actions)

    %% Ch·ªçn h√†nh ƒë·ªông - Edit Job
    Recruiter->>UI: 7. Nh·∫•n n√∫t "Edit" tr√™n 1 job
    UI->>Server: 8. GET /api/jobs/:id
    Server->>DB: 9. SELECT * FROM Jobs<br/>WHERE id = ? AND company_id = ?
    DB-->>Server: 10. Tr·∫£ v·ªÅ th√¥ng tin job
    Server-->>UI: 11. Tr·∫£ v·ªÅ data
    UI-->>Recruiter: 12. Hi·ªÉn th·ªã form ch·ªânh s·ª≠a<br/>(pre-fill d·ªØ li·ªáu)

    %% Ch·ªânh s·ª≠a v√† l∆∞u
    Recruiter->>UI: 13. Ch·ªânh s·ª≠a th√¥ng tin<br/>(Title, Description, Salary, Location...)
    Recruiter->>UI: 14. Nh·∫•n "L∆∞u thay ƒë·ªïi"
    
    UI->>Server: 15. PUT /api/jobs/:id<br/>(Updated data)
    
    Server->>Server: 16. Validate d·ªØ li·ªáu<br/>(Title not empty, Expiry > Today,<br/>Salary min <= max)
    
    alt Validation th√†nh c√¥ng
        Server->>DB: 17. UPDATE Jobs<br/>SET title=?, description=?, salary_min=?,<br/>salary_max=?, location=?, updated_at=NOW()<br/>WHERE id=? AND company_id=?
        DB-->>Server: 18. X√°c nh·∫≠n c·∫≠p nh·∫≠t
        
        Server->>DB: 19. INSERT INTO JobLogs<br/>(job_id, action, admin_id, details)
        DB-->>Server: 20. Log ƒë√£ l∆∞u
        
        Server-->>UI: 21. Tr·∫£ v·ªÅ success
        UI-->>Recruiter: 22. ‚úÖ "C·∫≠p nh·∫≠t tin th√†nh c√¥ng"
        UI->>UI: 23. Quay l·∫°i danh s√°ch
        
    else Validation th·∫•t b·∫°i
        Server-->>UI: ‚ùå L·ªói validation<br/>(Title tr·ªëng, Expiry < Today...)
        UI-->>Recruiter: Hi·ªÉn th·ªã th√¥ng b√°o l·ªói<br/>t·∫°i c√°c tr∆∞·ªùng kh√¥ng h·ª£p l·ªá
    end

    </div>
</body>
</html>